(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72906,e=>{"use strict";e.s(["default",()=>O],72906);var t=e.i(43476),s=e.i(71645),a=e.i(73477),r=e.i(15288),i=e.i(87486),n=e.i(19455),l=e.i(26895),c=e.i(7471),o=e.i(47167);function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let m=new class{async checkFact(e,t,s){try{let a=await this.analyzeClaim(e,t),r=s?await this.verifySource(s):null,i=.5;return r&&(i+=.3*r.credibility_score),i+=.3*a.evidence_quality,i=Math.max(0,Math.min(1,i)),{result:this.determineFactCheckResult(a),confidence_score:Math.round(100*i)/100,explanation:this.generateExplanation(a,r),sources:this.extractSources(t,s),analysis:a}}catch(t){return console.error("Fact-checking error:",t),{result:"unverifiable",confidence_score:0,explanation:"Impossible de vérifier cette information automatiquement.",sources:[],analysis:{claim:e,evidence_quality:0,source_reliability:0,political_bias:"neutral",content_sentiment:"neutral"}}}}async verifySource(e){try{let t=new URL(e).hostname,s=this.getSourceCredibility(t);return{url:e,domain:t,credibility_score:Number(s.credibility)||0,bias_rating:s.bias||"unknown",factual_reporting:s.factual||"mixed",is_reliable:Number(s.credibility)>=.6,notes:Array.isArray(s.notes)?s.notes:[String(s.notes||"")]}}catch(t){return console.error("Source verification error:",t),{url:e,domain:"unknown",credibility_score:.5,bias_rating:"unknown",factual_reporting:"mixed",is_reliable:!1,notes:["Impossible de vérifier la source"]}}}async analyzeContent(e){let t=this.extractKeywords(e),s=this.analyzeSentiment(e),a=this.detectBias(e);return{sentiment:s,bias:a,quality:this.assessQuality(e),keywords:t,topics:this.extractTopics(e)}}async analyzeClaim(e,t){let s=this.assessEvidenceQuality(t),a=this.assessSourceReliability(t);return{claim:e,evidence_quality:s,source_reliability:a,political_bias:this.detectBias(t),content_sentiment:this.analyzeSentiment(t)}}determineFactCheckResult(e){let{evidence_quality:t,source_reliability:s}=e,a=(Number(t)+Number(s))/2;return a>=.85?"true":a>=.7?"mostly_true":a>=.5?"partially_true":a>=.3?"mostly_false":a>=.1?"false":"unverifiable"}generateExplanation(e,t){let s="Analyse automatique de la déclaration:\n\n";return s+="• Qualité des preuves: ".concat(Math.round(100*Number(e.evidence_quality)),"%\n"),s+="• Fiabilité des sources: ".concat(Math.round(100*Number(e.source_reliability)),"%\n"),t&&(s+="• Crédibilité du domaine: ".concat(Math.round(100*t.credibility_score),"%\n"),s+="• Orientation politique détectée: ".concat(this.translateBias(t.bias_rating),"\n")),s+="\nCette analyse est automatique et doit être vérifiée par des modérateurs humains."}extractSources(e,t){let s=[];t&&s.push(t);let a=e.match(/https?:\/\/[^\s]+/g)||[];return s.push(...a),[...new Set(s)]}getSourceCredibility(e){return({"lemonde.fr":{credibility:.9,bias:"center-left",factual:"very_high",notes:["Source réputée","Journalisme de qualité"]},"lefigaro.fr":{credibility:.85,bias:"center-right",factual:"high",notes:["Source établie","Orientation conservatrice"]},"liberation.fr":{credibility:.8,bias:"left",factual:"high",notes:["Orientation progressiste","Journalisme engagé"]},"france24.com":{credibility:.9,bias:"center",factual:"very_high",notes:["Service public","International"]},"bfmtv.com":{credibility:.7,bias:"center",factual:"mostly_factual",notes:["Média continu","Qualité variable"]}})[e]||{credibility:.5,bias:"unknown",factual:"mixed",notes:["Source inconnue - vérification manuelle requise"]}}assessEvidenceQuality(e){let t=.5;return e.length>200&&(t+=.1),e.length>500&&(t+=.1),e.includes("http")&&(t+=.1),/\d{4}/.test(e)&&(t+=.05),/\d+%/.test(e)&&(t+=.05),/\d+\s*(euros?|dollars?)/.test(e)&&(t+=.05),(e.match(/https?:\/\/[^\s]+/g)||[]).length>1&&(t+=.1),Math.min(t,1)}assessSourceReliability(e){let t=.5;return(e.includes("selon")||e.includes("d'après"))&&(t+=.1),(e.includes("étude")||e.includes("enquête"))&&(t+=.1),(e.includes("officiel")||e.includes("ministère"))&&(t+=.1),(e.includes("rumeur")||e.includes("on dit que"))&&(t-=.2),(e.includes("peut-être")||e.includes("probablement"))&&(t-=.1),Math.max(0,Math.min(t,1))}detectBias(e){let t=["social","égalité","redistribution","public"].filter(t=>e.toLowerCase().includes(t)).length,s=["entreprise","marché","privatisation","sécuritaire"].filter(t=>e.toLowerCase().includes(t)).length;return t>s+1?"left":s>t+1?"right":1>=Math.abs(t-s)?"center":"neutral"}analyzeSentiment(e){let t=["excellent","bon","réussi","efficace","positif"].filter(t=>e.toLowerCase().includes(t)).length,s=["mauvais","échec","problème","critique","négatif"].filter(t=>e.toLowerCase().includes(t)).length;return t>s?"positive":s>t?"negative":"neutral"}assessQuality(e){let t=.5;return e.length>100&&(t+=.1),e.length>300&&(t+=.1),e.includes(".")&&e.split(".").length>2&&(t+=.1),/[A-Z]/.test(e)&&(t+=.05),/\d/.test(e)&&(t+=.1),e.includes("%")&&(t+=.05),Math.min(t,1)}extractKeywords(e){let t=e.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(e=>e.length>3),s={};return t.forEach(e=>{s[e]=(s[e]||0)+1}),Object.entries(s).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10).map(e=>{let[t]=e;return t})}extractTopics(e){let t=[];return/économie|budget|fiscal|emploi/i.test(e)&&t.push("Économie"),/santé|médical|hôpital/i.test(e)&&t.push("Santé"),/éducation|école|université/i.test(e)&&t.push("Éducation"),/sécurité|police|justice/i.test(e)&&t.push("Sécurité"),/environnement|climat|écologie/i.test(e)&&t.push("Environnement"),/international|europe|monde/i.test(e)&&t.push("International"),t}translateBias(e){return({left:"Gauche","center-left":"Centre-gauche",center:"Centre","center-right":"Centre-droit",right:"Droite",unknown:"Inconnu"})[e]||e}constructor(){d(this,"apiKey",null),this.apiKey=o.default.env.NEXT_PUBLIC_FACT_CHECK_API_KEY||null}};var u=e.i(98919),h=e.i(69638),x=e.i(73884),p=e.i(3116),g=e.i(75254);let y=(0,g.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var v=e.i(86536);let j=(0,g.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);var b=e.i(78917),f=e.i(17923);let N=(0,g.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),_=(0,g.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function w(){var e,a,o,d;let{user:g}=(0,l.useAuth)(),[w,C]=(0,s.useState)([]),[k,S]=(0,s.useState)(null),[M,A]=(0,s.useState)(!0),[T,B]=(0,s.useState)("pending"),[q]=(0,s.useState)(null),[E,z]=(0,s.useState)(""),[R,I]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{var e,t,s,a;g&&((null==(e=g.user_metadata)?void 0:e.role)==="admin"||(null==(t=g.user_metadata)?void 0:t.role)==="moderator"||(null==(s=g.profile)?void 0:s.role)==="admin"||(null==(a=g.profile)?void 0:a.role)==="moderator")&&L()},[g,T]);let L=async()=>{try{var e,t;A(!0),console.log("Current user:",g),console.log("User metadata role:",null==g||null==(e=g.user_metadata)?void 0:e.role),console.log("User profile role:",null==g||null==(t=g.profile)?void 0:t.role);let s=c.supabase.from("votes").select("\n          *,\n          user:users(name, reputation_score),\n          politician:politicians(name)\n        ").order("created_at",{ascending:!1}).limit(50);"all"!==T&&(s=s.eq("status",T));let{data:a,error:r}=await s;if(console.log("Moderation dashboard - selectedTab:",T),console.log("Moderation dashboard - votesData:",a),console.log("Moderation dashboard - votesError:",r),r){console.log("Primary query had issues, using fallback query without JOINs:",r);let{data:e,error:t}=await c.supabase.from("votes").select("*").order("created_at",{ascending:!1}).limit(50);if(console.log("Fallback query - data:",e),console.log("Fallback query - error:",t),e&&!t){console.log("Using fallback data - found votes:",e.length);let t=e;"all"!==T&&(t=e.filter(e=>e.status===T));let s=[];t.forEach(e=>{s.push({id:e.id,type:"vote",status:e.status,priority:D(e),content:e,created_at:e.created_at,reviewed_at:e.reviewed_at,reviewed_by:e.reviewed_by})}),C(s),await O();return}}let{data:i}=await c.supabase.from("comments").select("\n          *,\n          user:users(name, reputation_score)\n        ").eq("is_flagged",!0).eq("status","active").order("created_at",{ascending:!1}).limit(20),n=[];null==a||a.forEach(e=>{n.push({id:e.id,type:"vote",status:e.status,priority:D(e),content:e,created_at:e.created_at,reviewed_at:e.reviewed_at,reviewed_by:e.reviewed_by})}),null==i||i.forEach(e=>{n.push({id:e.id,type:"comment",status:"flagged",priority:"medium",content:e,created_at:e.created_at})}),C(n),await O()}catch(e){console.error("Error fetching moderation data:",e)}finally{A(!1)}},O=async()=>{try{let{data:e}=await c.supabase.rpc("get_moderation_stats");e&&S(e[0])}catch(e){console.error("Error fetching stats:",e)}},D=e=>{if("vote"===e.type){if(e.points&&e.points>=50)return"urgent";if(e.points&&e.points>=20)return"high";if(e.points&&e.points>=10)return"medium"}return"low"},P=async(e,t,s)=>{if(g){I(t=>new Set(t).add(e));try{let a=w.find(t=>t.id===e);if(!a)return;"vote"===a.type?await c.supabase.from("votes").update({status:"approve"===t?"approved":"rejected",reviewed_at:new Date().toISOString(),reviewed_by:g.id,rejection_reason:s||null}).eq("id",e):"comment"===a.type&&await c.supabase.from("comments").update({status:"approve"===t?"active":"hidden",is_flagged:!1,moderated_at:new Date().toISOString(),moderated_by:g.id}).eq("id",e),await c.supabase.from("moderation_actions").insert({moderator_id:g.id,item_type:a.type,item_id:e,action:t,reason:s||null}),await L()}catch(e){console.error("Error moderating item:",e)}finally{I(t=>{let s=new Set(t);return s.delete(e),s})}}},U=async e=>{I(t=>new Set(t).add(e));try{let t=w.find(t=>t.id===e);if(!t)return;let s="",a="";"vote"===t.type?(s=String(t.content.evidence_title||""),a=String(t.content.evidence_description||"")+" "+String(t.content.evidence_url||"")):"comment"===t.type&&(a=s=String(t.content.content||""));let r=await m.checkFact(s,a,String(t.content.evidence_url||""));await c.supabase.from("vote"===t.type?"votes":"comments").update({ai_analysis:r}).eq("id",e),await L()}catch(e){console.error("Error running AI analysis:",e)}finally{I(t=>{let s=new Set(t);return s.delete(e),s})}};return g&&((null==(e=g.user_metadata)?void 0:e.role)==="admin"||(null==(a=g.user_metadata)?void 0:a.role)==="moderator"||(null==(o=g.profile)?void 0:o.role)==="admin"||(null==(d=g.profile)?void 0:d.role)==="moderator")?M?(0,t.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-24 bg-gray-200 rounded-lg"},s))}),(0,t.jsx)("div",{className:"h-96 bg-gray-200 rounded-lg"})]})}):(0,t.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de modération"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Gérer le contenu et maintenir la qualité de la plateforme"})]}),(0,t.jsxs)(n.Button,{onClick:L,variant:"outline",size:"sm",children:[(0,t.jsx)(_,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]}),k&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"En attente"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:k.total_pending})]}),(0,t.jsx)(p.Clock,{className:"w-8 h-8 text-yellow-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Approuvés"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:k.total_approved})]}),(0,t.jsx)(h.CheckCircle,{className:"w-8 h-8 text-green-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Rejetés"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:k.total_rejected})]}),(0,t.jsx)(x.XCircle,{className:"w-8 h-8 text-red-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Précision IA"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[Math.round(k.accuracy_rate),"%"]})]}),(0,t.jsx)(f.BarChart3,{className:"w-8 h-8 text-blue-600"})]})})})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[(0,t.jsx)("div",{className:"flex space-x-2",children:[{key:"pending",label:"En attente",count:(null==k?void 0:k.total_pending)||0},{key:"flagged",label:"Signalés",count:(null==k?void 0:k.total_flagged)||0},{key:"approved",label:"Approuvés",count:(null==k?void 0:k.total_approved)||0},{key:"rejected",label:"Rejetés",count:(null==k?void 0:k.total_rejected)||0},{key:"all",label:"Tous",count:0}].map(e=>(0,t.jsxs)(n.Button,{onClick:()=>B(e.key),variant:T===e.key?"default":"outline",size:"sm",children:[e.label,e.count>0&&(0,t.jsx)(i.Badge,{variant:"secondary",className:"ml-2",children:e.count})]},e.key))}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(N,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Rechercher...",value:E,onChange:e=>z(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[w.filter(e=>!E||"vote"===e.type&&String(e.content.evidence_title||"").toLowerCase().includes(E.toLowerCase())||"comment"===e.type&&String(e.content.content||"").toLowerCase().includes(E.toLowerCase())).map(e=>{var s,a,l;return(0,t.jsx)(r.Card,{className:q===e.id?"ring-2 ring-blue-500":"",children:(0,t.jsxs)(r.CardContent,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full ".concat("vote"===e.type?"bg-blue-100 text-blue-600":"bg-purple-100 text-purple-600"),children:"vote"===e.type?(0,t.jsx)(f.BarChart3,{className:"w-5 h-5"}):(0,t.jsx)(j,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Badge,{variant:"outline",className:(e=>{switch(e){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.priority),children:e.priority.toUpperCase()}),(0,t.jsx)(i.Badge,{variant:"outline",className:(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"flagged":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status),children:e.status}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"vote"===e.type?"Vote":"Commentaire"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[new Date(e.created_at).toLocaleDateString("fr-FR")," à ",new Date(e.created_at).toLocaleTimeString("fr-FR")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(n.Button,{onClick:()=>U(e.id),disabled:R.has(e.id),variant:"outline",size:"sm",children:[(0,t.jsx)(v.Eye,{className:"w-4 h-4 mr-1"}),"Analyser"]}),"pending"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Button,{onClick:()=>P(e.id,"approve"),disabled:R.has(e.id),variant:"outline",size:"sm",className:"text-green-600 hover:text-green-700",children:[(0,t.jsx)(h.CheckCircle,{className:"w-4 h-4 mr-1"}),"Approuver"]}),(0,t.jsxs)(n.Button,{onClick:()=>P(e.id,"reject"),disabled:R.has(e.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:[(0,t.jsx)(x.XCircle,{className:"w-4 h-4 mr-1"}),"Rejeter"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:["vote"===e.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:String(e.content.evidence_title||"")}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:String(e.content.evidence_description||"")})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"font-medium ".concat("positive"===String(e.content.vote_type)?"text-green-600":"text-red-600"),children:["positive"===String(e.content.vote_type)?"+":"-",String(e.content.points||"0")," points"]}),(0,t.jsxs)("span",{className:"text-gray-600",children:["Catégorie: ",String(e.content.category||"")]})]}),!!e.content.evidence_url&&""!==String(e.content.evidence_url).trim()&&(0,t.jsxs)("a",{href:String(e.content.evidence_url||""),target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800",children:[(0,t.jsx)(b.ExternalLink,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Source"})]})]})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-700",children:String(e.content.content||"")}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm mt-2",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["Par ",String((null==(s=e.content.user)?void 0:s.name)||"Utilisateur anonyme")]}),(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-orange-50 text-orange-700",children:[(0,t.jsx)(y,{className:"w-3 h-3 mr-1"}),"Signalé"]})]})]}),!!e.content.ai_analysis&&"object"==typeof e.content.ai_analysis&&null!==e.content.ai_analysis&&(0,t.jsxs)("div",{className:"border-t pt-3 mt-3",children:[(0,t.jsx)("h5",{className:"font-medium text-sm mb-2",children:"Analyse IA"}),(0,t.jsxs)("div",{className:"text-sm space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Résultat:"}),(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:String((null==(a=e.content.ai_analysis)?void 0:a.result)||"")})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Confiance:"}),(0,t.jsxs)("span",{className:"font-medium",children:[Math.round(100*Number((null==(l=e.content.ai_analysis)?void 0:l.confidence_score)||0)),"%"]})]})]})]})]})]})},e.id)}),0===w.length&&(0,t.jsx)(r.Card,{className:"text-center py-12",children:(0,t.jsxs)(r.CardContent,{children:[(0,t.jsx)(u.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Aucun élément à modérer"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Tous les éléments ont été traités."})]})})]})]}):(0,t.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,t.jsx)(r.Card,{className:"text-center py-12",children:(0,t.jsxs)(r.CardContent,{children:[(0,t.jsx)(u.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Accès non autorisé"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Vous devez être administrateur ou modérateur pour accéder à cette page."})]})})})}var C=e.i(68148);let k=new class{async analyzeThreat(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let s=await this.getUserBehaviorProfile(t),a=await this.analyzeContent(e),r=await this.detectCoordinatedBehavior(t,e),i=await this.detectBotBehavior(s),n=await this.analyzeNetworkThreats(t),l={coordinated_behavior:r,bot_probability:i,spam_likelihood:a.spam_score,manipulation_risk:this.calculateManipulationRisk(s,a),disinformation_score:a.disinformation_score},c=this.calculateThreatLevel(l),o=this.identifyThreatTypes(l,a),d=this.detectAnomalies(s,a,n),m=this.generateRecommendations(c,o,d);return{threat_level:c,threat_types:o,confidence_score:this.calculateConfidence(l),risk_factors:l,anomalies:d.map(e=>({type:String(e.type||"unknown"),description:String(e.description||""),severity:Number(e.severity||0)})),recommendations:m}}catch(e){return console.error("Threat detection error:",e),{threat_level:"low",threat_types:[],confidence_score:0,risk_factors:{coordinated_behavior:0,bot_probability:0,spam_likelihood:0,manipulation_risk:0,disinformation_score:0},anomalies:[],recommendations:["Analyse manuelle recommandée - erreur système"]}}}async analyzeNetworkThreats(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let e=await this.detectSuspiciousClusters(),t=await this.detectBotNetworks(),s=await this.detectInfluenceOperations();return{suspicious_clusters:e.map(e=>({cluster_id:String(e.cluster_id||""),size:Number(e.size||0),coordination_score:Number(e.coordination_score||0),members:Array.isArray(e.members)?e.members:[],behavior_patterns:Array.isArray(e.behavior_patterns)?e.behavior_patterns:[]})),bot_networks:t.map(e=>({network_id:String(e.network_id||""),confidence:Number(e.confidence||0),members:Array.isArray(e.members)?e.members:[],evidence:Array.isArray(e.evidence)?e.evidence:[]})),influence_operations:s.map(e=>({operation_id:String(e.operation_id||""),type:e.type||"disinformation",scale:Number(e.scale||0),targets:Array.isArray(e.targets)?e.targets:[],indicators:Array.isArray(e.indicators)?e.indicators:[]}))}}catch(e){return console.error("Network analysis error:",e),{suspicious_clusters:[],bot_networks:[],influence_operations:[]}}}async getUserBehaviorProfile(e){return{user_id:e,voting_patterns:{frequency:10*Math.random(),timing_variance:Math.random(),target_diversity:Math.random(),evidence_quality:Math.random()},engagement_metrics:{comment_frequency:5*Math.random(),interaction_depth:Math.random(),response_time_patterns:[100*Math.random(),100*Math.random()],activity_times:[24*Math.random(),24*Math.random()]},content_analysis:{sentiment_consistency:Math.random(),topic_focus:["politics","economics"],language_patterns:{},credibility_sources:10*Math.random()},network_analysis:{connection_patterns:{},influence_score:100*Math.random(),cluster_membership:[]}}}async analyzeContent(e){let t=["click here","free money","guaranteed","urgent","limited time"],s=t.filter(t=>e.toLowerCase().includes(t)).length/t.length,a=[/fake news/i,/conspiracy/i,/they don't want you to know/i,/wake up/i,/do your research/i],r=a.filter(t=>t.test(e)).length/a.length,i=["outrageous","shocking","unbelievable","scandalous","terrifying"];return{spam_score:s,disinformation_score:r,emotional_manipulation:i.filter(t=>e.toLowerCase().includes(t)).length/i.length,readability:this.calculateReadability(e),credibility_indicators:this.analyzeCredibilityIndicators(e)}}async detectCoordinatedBehavior(e,t){return Math.min(1,.3*Math.floor(3*Math.random())+.5*Math.random()+.3*Math.random())}async detectBotBehavior(e){let t=0;e.voting_patterns.timing_variance<.2&&(t+=.3),e.engagement_metrics.interaction_depth<.3&&(t+=.2);let s=this.calculateVariance(e.engagement_metrics.activity_times);return(s<2||s>10)&&(t+=.2),e.content_analysis.topic_focus.length<2&&(t+=.15),5>this.calculateVariance(e.engagement_metrics.response_time_patterns)&&(t+=.15),Math.min(1,t)}calculateManipulationRisk(e,t){let s=0;return e.voting_patterns.frequency>5&&e.voting_patterns.evidence_quality<.3&&(s+=.4),s+=.3*Number(t.emotional_manipulation),e.voting_patterns.target_diversity<.3&&(s+=.2),e.content_analysis.sentiment_consistency<.4&&(s+=.1),Math.min(1,s)}detectSuspiciousClusters(){return[{cluster_id:"cluster_001",size:15,coordination_score:.85,members:["user1","user2","user3"],behavior_patterns:["synchronized_voting","similar_content","timing_correlation"]}]}detectBotNetworks(){return[{network_id:"botnet_001",confidence:.78,members:["bot1","bot2","bot3"],evidence:["identical_timing","template_content","coordinated_targets"]}]}detectInfluenceOperations(){return[{operation_id:"influence_001",type:"astroturfing",scale:7.5,targets:["politician_123","politician_456"],indicators:["artificial_amplification","coordinated_messaging","fake_grassroots"]}]}calculateThreatLevel(e){let t=Object.values(e).reduce((e,t)=>e+Number(t),0)/Object.keys(e).length;return t>=.8?"critical":t>=.6?"high":t>=.3?"medium":"low"}identifyThreatTypes(e,t){let s=[];return Number(e.bot_probability)>.6&&s.push("bot_activity"),Number(e.coordinated_behavior)>.7&&s.push("coordinated_manipulation"),Number(e.spam_likelihood)>.5&&s.push("spam"),Number(e.disinformation_score)>.6&&s.push("disinformation"),Number(e.manipulation_risk)>.6&&s.push("vote_manipulation"),Number(t.emotional_manipulation)>.7&&s.push("emotional_manipulation"),s}detectAnomalies(e,t,s){let a=[];return e.voting_patterns.frequency>8&&a.push({type:"high_frequency_voting",description:"Fréquence de vote anormalement élevée",severity:6}),e.voting_patterns.timing_variance<.1&&a.push({type:"robotic_timing",description:"Patterns temporels trop réguliers (comportement robotique)",severity:7}),s.suspicious_clusters.length>0&&a.push({type:"cluster_membership",description:"Membre d'un cluster suspect",severity:8}),a}generateRecommendations(e,t,s){let a=[];return"critical"===e?(a.push("Blocage immédiat recommandé"),a.push("Investigation approfondie requise")):"high"===e?(a.push("Surveillance renforcée"),a.push("Révision manuelle de tous les contenus")):"medium"===e&&(a.push("Modération prioritaire"),a.push("Vérification des sources")),t.includes("bot_activity")&&a.push("Vérification CAPTCHA supplémentaire"),t.includes("coordinated_manipulation")&&a.push("Analyse du réseau de connexions"),t.includes("disinformation")&&a.push("Fact-checking approfondi requis"),s.some(e=>Number(e.severity)>=8)&&a.push("Escalade vers l'équipe sécurité"),a.length>0?a:["Surveillance standard"]}calculateConfidence(e){let t=Object.values(e),s=t.reduce((e,t)=>e+t,0)/t.length;return Math.max(.1,Math.min(1,1-t.reduce((e,t)=>e+Math.pow(t-s,2),0)/t.length))}calculateReadability(e){let t=e.split(/[.!?]+/).filter(e=>e.trim().length>0),s=e.split(/\s+/),a=s.reduce((e,t)=>e+this.countSyllables(t),0);return 0===t.length||0===s.length?0:Math.max(0,Math.min(100,206.835-1.015*(s.length/t.length)-84.6*(a/s.length)))/100}countSyllables(e){let t=0,s=!1;for(let a=0;a<e.length;a++){let r="aeiouy".includes(e[a].toLowerCase());r&&!s&&t++,s=r}return Math.max(1,t)}analyzeCredibilityIndicators(e){let t=.5;return/https?:\/\//.test(e)&&(t+=.2),/\d+%|\d+\s*(euros?|dollars?)|\d{4}/.test(e)&&(t+=.1),/(selon|d'après|il semble|probablement)/.test(e.toLowerCase())&&(t+=.1),/(toujours|jamais|tous|aucun)/.test(e.toLowerCase())&&!/https?:\/\//.test(e)&&(t-=.2),Math.max(0,Math.min(1,t))}hashContent(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return t.toString()}calculateVariance(e){if(0===e.length)return 0;let t=e.reduce((e,t)=>e+t,0)/e.length;return e.reduce((e,s)=>e+Math.pow(s-t,2),0)/e.length}async startRealTimeMonitoring(){console.log("Starting real-time threat monitoring...")}async stopRealTimeMonitoring(){console.log("Stopping real-time threat monitoring...")}async processBatchAnalysis(e){return console.log("Processing batch analysis for ".concat(e,"...")),{processed_users:0,threats_detected:0,anomalies_found:0}}constructor(){d(this,"modelEndpoint",null),d(this,"apiKey",null),this.modelEndpoint=o.default.env.ML_THREAT_DETECTION_ENDPOINT||null,this.apiKey=o.default.env.ML_API_KEY||null}};var S=e.i(78894);let M=(0,g.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var A=e.i(61911);let T=(0,g.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var B=e.i(25652);let q=(0,g.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),E=(0,g.default)("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);var z=e.i(20278);function R(){let[e,a]=(0,s.useState)([]),[l,c]=(0,s.useState)(null),[o,d]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!0),[g,y]=(0,s.useState)("overview");(0,s.useEffect)(()=>{j(),b()},[]);let j=async()=>{try{p(!0);let e=[{id:"1",type:"coordinated_behavior",severity:"high",description:"Détection de comportement coordonné entre 15 comptes",user_id:"user_123",detected_at:new Date(Date.now()-18e5).toISOString(),status:"active",ml_confidence:.87},{id:"2",type:"bot_activity",severity:"medium",description:"Activité suspecte de bot détectée",user_id:"user_456",detected_at:new Date(Date.now()-72e5).toISOString(),status:"investigating",ml_confidence:.74},{id:"3",type:"disinformation",severity:"critical",description:"Propagation de désinformation détectée",content_id:"vote_789",detected_at:new Date(Date.now()-6e5).toISOString(),status:"active",ml_confidence:.92}];a(e);let t=await k.analyzeNetworkThreats();c(t)}catch(e){console.error("Error fetching threat data:",e)}finally{p(!1)}},b=async()=>{d(!0),await k.startRealTimeMonitoring()},f=async()=>{d(!1),await k.stopRealTimeMonitoring()},N=async(e,t)=>{a(s=>s.map(s=>s.id===e?{...s,status:t}:s))},w=e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},R=e=>{switch(e){case"bot_activity":return(0,t.jsx)(M,{className:"w-4 h-4"});case"coordinated_behavior":return(0,t.jsx)(A.Users,{className:"w-4 h-4"});case"disinformation":return(0,t.jsx)(S.AlertTriangle,{className:"w-4 h-4"});case"spam":return(0,t.jsx)(q,{className:"w-4 h-4"});case"manipulation":return(0,t.jsx)(z.Target,{className:"w-4 h-4"});default:return(0,t.jsx)(u.Shield,{className:"w-4 h-4"})}};return m?(0,t.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-24 bg-gray-200 rounded-lg"},s))}),(0,t.jsx)("div",{className:"h-96 bg-gray-200 rounded-lg"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Surveillance des menaces"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Détection automatisée des menaces par IA"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-full ".concat(o?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:[(0,t.jsx)(T,{className:"w-4 h-4 ".concat(o?"animate-pulse":"")}),(0,t.jsx)("span",{className:"text-sm font-medium",children:o?"Surveillance active":"Surveillance arrêtée"})]}),(0,t.jsx)(n.Button,{onClick:o?f:b,variant:o?"destructive":"default",size:"sm",children:o?"Arrêter":"Démarrer"}),(0,t.jsxs)(n.Button,{onClick:j,variant:"outline",size:"sm",children:[(0,t.jsx)(_,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Menaces actives"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.filter(e=>"active"===e.status).length})]}),(0,t.jsx)(S.AlertTriangle,{className:"w-8 h-8 text-red-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Bots détectés"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.filter(e=>"bot_activity"===e.type).length})]}),(0,t.jsx)(M,{className:"w-8 h-8 text-orange-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Réseaux suspects"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null==l?void 0:l.suspicious_clusters.length)||0})]}),(0,t.jsx)(E,{className:"w-8 h-8 text-purple-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Confiance IA"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[e.length>0?Math.round(e.reduce((e,t)=>e+t.ml_confidence,0)/e.length*100):0,"%"]})]}),(0,t.jsx)(v.Eye,{className:"w-8 h-8 text-blue-600"})]})})})]}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Vue d'ensemble",icon:(0,t.jsx)(u.Shield,{className:"w-4 h-4"})},{key:"threats",label:"Menaces",icon:(0,t.jsx)(S.AlertTriangle,{className:"w-4 h-4"})},{key:"network",label:"Analyse réseau",icon:(0,t.jsx)(E,{className:"w-4 h-4"})},{key:"analytics",label:"Analytics ML",icon:(0,t.jsx)(B.TrendingUp,{className:"w-4 h-4"})}].map(e=>(0,t.jsxs)("button",{onClick:()=>y(e.key),className:"flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ".concat(g===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.icon,(0,t.jsx)("span",{children:e.label})]},e.key))})}),"overview"===g&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Menaces récentes"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:e.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[R(e.type),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.description}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.detected_at).toLocaleString("fr-FR")})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Badge,{variant:"outline",className:w(e.severity),children:e.severity}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(100*e.ml_confidence),"%"]})]})]},e.id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Analyse de tendances"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Activité bot"}),(0,t.jsx)("span",{children:"23%"})]}),(0,t.jsx)(C.Progress,{value:23,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Coordination suspecte"}),(0,t.jsx)("span",{children:"45%"})]}),(0,t.jsx)(C.Progress,{value:45,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Désinformation"}),(0,t.jsx)("span",{children:"12%"})]}),(0,t.jsx)(C.Progress,{value:12,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Manipulation"}),(0,t.jsx)("span",{children:"31%"})]}),(0,t.jsx)(C.Progress,{value:31,className:"h-2"})]})]})})]})]}),"threats"===g&&(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,t.jsx)(r.Card,{children:(0,t.jsxs)(r.CardContent,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full ".concat("critical"===e.severity?"bg-red-100 text-red-600":"high"===e.severity?"bg-orange-100 text-orange-600":"medium"===e.severity?"bg-yellow-100 text-yellow-600":"bg-blue-100 text-blue-600"),children:R(e.type)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["Type: ",e.type]}),(0,t.jsxs)("span",{children:["Confiance: ",Math.round(100*e.ml_confidence),"%"]}),(0,t.jsx)("span",{children:new Date(e.detected_at).toLocaleString("fr-FR")})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Badge,{variant:"outline",className:w(e.severity),children:e.severity}),(0,t.jsx)(i.Badge,{variant:"outline",className:(e=>{switch(e){case"active":return"bg-red-100 text-red-800 border-red-200";case"investigating":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status),children:e.status})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(n.Button,{onClick:()=>N(e.id,"investigating"),size:"sm",variant:"outline",children:[(0,t.jsx)(v.Eye,{className:"w-4 h-4 mr-1"}),"Enquêter"]}),(0,t.jsxs)(n.Button,{onClick:()=>N(e.id,"resolved"),size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700",children:[(0,t.jsx)(h.CheckCircle,{className:"w-4 h-4 mr-1"}),"Résolu"]}),(0,t.jsxs)(n.Button,{onClick:()=>N(e.id,"false_positive"),size:"sm",variant:"outline",className:"text-gray-600 hover:text-gray-700",children:[(0,t.jsx)(x.XCircle,{className:"w-4 h-4 mr-1"}),"Faux positif"]})]})]})},e.id))}),"network"===g&&(0,t.jsx)("div",{className:"space-y-6",children:l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Clusters suspects"})}),(0,t.jsx)(r.CardContent,{children:0===l.suspicious_clusters.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucun cluster suspect détecté"}):(0,t.jsx)("div",{className:"space-y-4",children:l.suspicious_clusters.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("h4",{className:"font-medium",children:["Cluster ",e.cluster_id]}),(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-orange-50 text-orange-700",children:[e.size," membres"]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Score de coordination: ",Math.round(100*e.coordination_score),"%"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.behavior_patterns.map((e,s)=>(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:e},s))})]},e.cluster_id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Réseaux de bots"})}),(0,t.jsx)(r.CardContent,{children:0===l.bot_networks.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucun réseau de bots détecté"}):(0,t.jsx)("div",{className:"space-y-4",children:l.bot_networks.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("h4",{className:"font-medium",children:["Réseau ",e.network_id]}),(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-red-50 text-red-700",children:["Confiance: ",Math.round(100*e.confidence),"%"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.evidence.map((e,s)=>(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:e},s))})]},e.network_id))})})]})]})}),"analytics"===g&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Analytics Machine Learning"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(B.TrendingUp,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Analytics ML avancées"}),(0,t.jsx)("p",{className:"text-sm",children:"Analyses détaillées et métriques de performance des modèles à venir."})]})})]})]})}let I=(0,g.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),L=(0,g.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function O(){var e,o,d,m,h,x,p;let{user:g,loading:y}=(0,l.useAuth)(),[j,b]=(0,s.useState)("overview"),[N,_]=(0,s.useState)(null),[C,k]=(0,s.useState)([]),[M,q]=(0,s.useState)(!0);(0,s.useEffect)(()=>{var e,t,s,a;g&&((null==(e=g.user_metadata)?void 0:e.role)==="admin"||(null==(t=g.user_metadata)?void 0:t.role)==="moderator"||(null==(s=g.profile)?void 0:s.role)==="admin"||(null==(a=g.profile)?void 0:a.role)==="moderator")&&(E(),z())},[g]);let E=async()=>{try{q(!0);let{count:e}=await c.supabase.from("users").select("*",{count:"exact",head:!0}),t=new Date().toISOString().split("T")[0],{count:s}=await c.supabase.from("votes").select("*",{count:"exact",head:!0}).gte("created_at",t),{count:a,data:r}=await c.supabase.from("votes").select("*",{count:"exact"}).eq("status","pending");console.log("Admin dashboard - pending count:",a),console.log("Admin dashboard - pending votes:",r),_({total_users:e||0,votes_today:s||0,pending_moderation:a||0,system_health:98})}catch(e){console.error("Error fetching admin stats:",e)}finally{q(!1)}},z=async()=>{try{let{data:e}=await c.supabase.from("moderation_actions").select("\n          *,\n          moderator:users!moderator_id(name)\n        ").order("created_at",{ascending:!1}).limit(10),{data:t}=await c.supabase.from("users").select("id, name, created_at").order("created_at",{ascending:!1}).limit(5),s=[];null==e||e.forEach(e=>{var t;s.push({id:e.id,action:"approve"===e.action?"Vote approuvé":"Vote rejeté",user:(null==(t=e.moderator)?void 0:t.name)||"Modérateur",time:O(e.created_at),type:"approve"===e.action?"approval":"rejection"})}),null==t||t.forEach(e=>{s.push({id:e.id,action:"Nouveau utilisateur",user:e.name||"Utilisateur",time:O(e.created_at),type:"user"})}),s.sort((e,t)=>new Date(t.time).getTime()-new Date(e.time).getTime()),k(s.slice(0,8))}catch(e){console.error("Error fetching recent activity:",e)}},O=e=>{let t=new Date,s=new Date(e),a=Math.floor((t.getTime()-s.getTime())/6e4);return a<1?"À l'instant":a<60?"Il y a ".concat(a," min"):a<1440?"Il y a ".concat(Math.floor(a/60),"h"):"Il y a ".concat(Math.floor(a/1440)," jour(s)")};if(y)return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(a.Navigation,{}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsx)("div",{className:"text-center",children:"Chargement..."})})]});if(!g||(null==(e=g.user_metadata)?void 0:e.role)!=="admin"&&(null==(o=g.user_metadata)?void 0:o.role)!=="moderator"&&(null==(d=g.profile)?void 0:d.role)!=="admin"&&(null==(m=g.profile)?void 0:m.role)!=="moderator")return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(a.Navigation,{}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsx)(r.Card,{className:"text-center py-12",children:(0,t.jsxs)(r.CardContent,{children:[(0,t.jsx)(u.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Accès non autorisé"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Vous devez être administrateur ou modérateur pour accéder à cette page."})]})})})]});let D=(null==(h=g.user_metadata)?void 0:h.role)==="admin"||(null==(x=g.profile)?void 0:x.role)==="admin";return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(a.Navigation,{}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:D?"Administration":"Modération"}),(0,t.jsx)("p",{className:"text-gray-600",children:D?"Gérer la plateforme et superviser les modérateurs":"Modérer le contenu et maintenir la qualité"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,t.jsx)(u.Shield,{className:"w-3 h-3 mr-1"}),D?"Administrateur":"Modérateur"]}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:(null==(p=g.profile)?void 0:p.name)||g.email})]})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Vue d'ensemble",icon:(0,t.jsx)(f.BarChart3,{className:"w-4 h-4"}),adminOnly:!1},{key:"moderation",label:"Modération",icon:(0,t.jsx)(u.Shield,{className:"w-4 h-4"}),adminOnly:!1},{key:"threats",label:"Menaces IA",icon:(0,t.jsx)(v.Eye,{className:"w-4 h-4"}),adminOnly:!1},{key:"users",label:"Utilisateurs",icon:(0,t.jsx)(A.Users,{className:"w-4 h-4"}),adminOnly:!0},{key:"analytics",label:"Analytics",icon:(0,t.jsx)(B.TrendingUp,{className:"w-4 h-4"}),adminOnly:!0},{key:"settings",label:"Paramètres",icon:(0,t.jsx)(I,{className:"w-4 h-4"}),adminOnly:!0}].filter(e=>!e.adminOnly||D).map(e=>(0,t.jsxs)("button",{onClick:()=>b(e.key),className:"flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ".concat(j===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.icon,(0,t.jsx)("span",{children:e.label})]},e.key))})}),"overview"===j&&(0,t.jsxs)("div",{className:"space-y-6",children:[M?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},s))}):(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(null==N?void 0:N.total_users)||0})]}),(0,t.jsx)(A.Users,{className:"w-8 h-8 text-blue-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Votes Today"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(null==N?void 0:N.votes_today)||0})]}),(0,t.jsx)(f.BarChart3,{className:"w-8 h-8 text-green-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Pending Moderation"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:(null==N?void 0:N.pending_moderation)||0})]}),(0,t.jsx)(S.AlertTriangle,{className:"w-8 h-8 text-orange-600"})]})})}),(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"System Health"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[(null==N?void 0:N.system_health)||0,"%"]})]}),(0,t.jsx)(T,{className:"w-8 h-8 text-green-600"})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Activité récente"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:C.length>0?C.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("approval"===e.type?"bg-green-500":"flag"===e.type?"bg-orange-500":"user"===e.type?"bg-blue-500":"bg-red-500")}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.action}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.user})]})]}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:e.time})]},e.id)):(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,t.jsx)("p",{className:"text-sm",children:"Aucune activité récente"})})})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Actions rapides"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",onClick:()=>b("moderation"),children:[(0,t.jsx)(u.Shield,{className:"w-4 h-4 mr-2"}),"Réviser la modération"]}),(0,t.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,t.jsx)(A.Users,{className:"w-4 h-4 mr-2"}),"Gérer les utilisateurs"]}),(0,t.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",onClick:()=>{E(),z()},children:[(0,t.jsx)(L,{className:"w-4 h-4 mr-2"}),"Actualiser les données"]}),(0,t.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,t.jsx)(I,{className:"w-4 h-4 mr-2"}),"Configuration système"]})]})})]})]})]}),"moderation"===j&&(0,t.jsx)(w,{}),"threats"===j&&(0,t.jsx)(R,{}),"users"===j&&D&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Gestion des utilisateurs"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(A.Users,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Gestion des utilisateurs"}),(0,t.jsx)("p",{className:"text-sm",children:"Cette fonctionnalité sera disponible prochainement."})]})})]})}),"analytics"===j&&D&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Analytics avancées"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(B.TrendingUp,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Analytics détaillées"}),(0,t.jsx)("p",{className:"text-sm",children:"Analyses approfondies en développement."})]})})]})}),"settings"===j&&D&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Paramètres système"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(I,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Configuration système"}),(0,t.jsx)("p",{className:"text-sm",children:"Paramètres avancés à venir."})]})})]})})]})]})}}]);