module.exports=[10179,a=>{"use strict";a.s(["default",()=>K],10179);var b=a.i(87924),c=a.i(72131),d=a.i(91181),e=a.i(91119),f=a.i(86304),g=a.i(99570),h=a.i(53713),i=a.i(10849);let j=new class{apiKey=null;constructor(){this.apiKey=process.env.NEXT_PUBLIC_FACT_CHECK_API_KEY||null}async checkFact(a,b,c){try{let d=await this.analyzeClaim(a,b),e=c?await this.verifySource(c):null,f=.5;return e&&(f+=.3*e.credibility_score),f+=.3*d.evidence_quality,f=Math.max(0,Math.min(1,f)),{result:this.determineFactCheckResult(d),confidence_score:Math.round(100*f)/100,explanation:this.generateExplanation(d,e),sources:this.extractSources(b,c),analysis:d}}catch(b){return console.error("Fact-checking error:",b),{result:"unverifiable",confidence_score:0,explanation:"Impossible de vérifier cette information automatiquement.",sources:[],analysis:{claim:a,evidence_quality:0,source_reliability:0,political_bias:"neutral",content_sentiment:"neutral"}}}}async verifySource(a){try{let b=new URL(a).hostname,c=this.getSourceCredibility(b);return{url:a,domain:b,credibility_score:Number(c.credibility)||0,bias_rating:c.bias||"unknown",factual_reporting:c.factual||"mixed",is_reliable:Number(c.credibility)>=.6,notes:Array.isArray(c.notes)?c.notes:[String(c.notes||"")]}}catch(b){return console.error("Source verification error:",b),{url:a,domain:"unknown",credibility_score:.5,bias_rating:"unknown",factual_reporting:"mixed",is_reliable:!1,notes:["Impossible de vérifier la source"]}}}async analyzeContent(a){let b=this.extractKeywords(a),c=this.analyzeSentiment(a),d=this.detectBias(a);return{sentiment:c,bias:d,quality:this.assessQuality(a),keywords:b,topics:this.extractTopics(a)}}async analyzeClaim(a,b){let c=this.assessEvidenceQuality(b),d=this.assessSourceReliability(b);return{claim:a,evidence_quality:c,source_reliability:d,political_bias:this.detectBias(b),content_sentiment:this.analyzeSentiment(b)}}determineFactCheckResult(a){let{evidence_quality:b,source_reliability:c}=a,d=(Number(b)+Number(c))/2;return d>=.85?"true":d>=.7?"mostly_true":d>=.5?"partially_true":d>=.3?"mostly_false":d>=.1?"false":"unverifiable"}generateExplanation(a,b){let c=`Analyse automatique de la d\xe9claration:

`;return c+=`• Qualit\xe9 des preuves: ${Math.round(100*Number(a.evidence_quality))}%
• Fiabilit\xe9 des sources: ${Math.round(100*Number(a.source_reliability))}%
`,b&&(c+=`• Cr\xe9dibilit\xe9 du domaine: ${Math.round(100*b.credibility_score)}%
• Orientation politique d\xe9tect\xe9e: ${this.translateBias(b.bias_rating)}
`),c+=`
Cette analyse est automatique et doit \xeatre v\xe9rifi\xe9e par des mod\xe9rateurs humains.`}extractSources(a,b){let c=[];b&&c.push(b);let d=a.match(/https?:\/\/[^\s]+/g)||[];return c.push(...d),[...new Set(c)]}getSourceCredibility(a){return({"lemonde.fr":{credibility:.9,bias:"center-left",factual:"very_high",notes:["Source réputée","Journalisme de qualité"]},"lefigaro.fr":{credibility:.85,bias:"center-right",factual:"high",notes:["Source établie","Orientation conservatrice"]},"liberation.fr":{credibility:.8,bias:"left",factual:"high",notes:["Orientation progressiste","Journalisme engagé"]},"france24.com":{credibility:.9,bias:"center",factual:"very_high",notes:["Service public","International"]},"bfmtv.com":{credibility:.7,bias:"center",factual:"mostly_factual",notes:["Média continu","Qualité variable"]}})[a]||{credibility:.5,bias:"unknown",factual:"mixed",notes:["Source inconnue - vérification manuelle requise"]}}assessEvidenceQuality(a){let b=.5;return a.length>200&&(b+=.1),a.length>500&&(b+=.1),a.includes("http")&&(b+=.1),/\d{4}/.test(a)&&(b+=.05),/\d+%/.test(a)&&(b+=.05),/\d+\s*(euros?|dollars?)/.test(a)&&(b+=.05),(a.match(/https?:\/\/[^\s]+/g)||[]).length>1&&(b+=.1),Math.min(b,1)}assessSourceReliability(a){let b=.5;return(a.includes("selon")||a.includes("d'après"))&&(b+=.1),(a.includes("étude")||a.includes("enquête"))&&(b+=.1),(a.includes("officiel")||a.includes("ministère"))&&(b+=.1),(a.includes("rumeur")||a.includes("on dit que"))&&(b-=.2),(a.includes("peut-être")||a.includes("probablement"))&&(b-=.1),Math.max(0,Math.min(b,1))}detectBias(a){let b=["social","égalité","redistribution","public"].filter(b=>a.toLowerCase().includes(b)).length,c=["entreprise","marché","privatisation","sécuritaire"].filter(b=>a.toLowerCase().includes(b)).length;return b>c+1?"left":c>b+1?"right":1>=Math.abs(b-c)?"center":"neutral"}analyzeSentiment(a){let b=["excellent","bon","réussi","efficace","positif"].filter(b=>a.toLowerCase().includes(b)).length,c=["mauvais","échec","problème","critique","négatif"].filter(b=>a.toLowerCase().includes(b)).length;return b>c?"positive":c>b?"negative":"neutral"}assessQuality(a){let b=.5;return a.length>100&&(b+=.1),a.length>300&&(b+=.1),a.includes(".")&&a.split(".").length>2&&(b+=.1),/[A-Z]/.test(a)&&(b+=.05),/\d/.test(a)&&(b+=.1),a.includes("%")&&(b+=.05),Math.min(b,1)}extractKeywords(a){let b=a.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(a=>a.length>3),c={};return b.forEach(a=>{c[a]=(c[a]||0)+1}),Object.entries(c).sort(([,a],[,b])=>b-a).slice(0,10).map(([a])=>a)}extractTopics(a){let b=[];return/économie|budget|fiscal|emploi/i.test(a)&&b.push("Économie"),/santé|médical|hôpital/i.test(a)&&b.push("Santé"),/éducation|école|université/i.test(a)&&b.push("Éducation"),/sécurité|police|justice/i.test(a)&&b.push("Sécurité"),/environnement|climat|écologie/i.test(a)&&b.push("Environnement"),/international|europe|monde/i.test(a)&&b.push("International"),b}translateBias(a){return({left:"Gauche","center-left":"Centre-gauche",center:"Centre","center-right":"Centre-droit",right:"Droite",unknown:"Inconnu"})[a]||a}};var k=a.i(3314),l=a.i(16201),m=a.i(62722),n=a.i(41710),o=a.i(70106);let p=(0,o.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var q=a.i(77156);let r=(0,o.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);var s=a.i(52495),t=a.i(39761);let u=(0,o.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),v=(0,o.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function w(){let{user:a}=(0,h.useAuth)(),[d,o]=(0,c.useState)([]),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)("pending"),[C]=(0,c.useState)(null),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(new Set);(0,c.useEffect)(()=>{a&&(a.user_metadata?.role==="admin"||a.user_metadata?.role==="moderator"||a.profile?.role==="admin"||a.profile?.role==="moderator")&&H()},[a,A]);let H=async()=>{try{z(!0),console.log("Current user:",a),console.log("User metadata role:",a?.user_metadata?.role),console.log("User profile role:",a?.profile?.role);let b=i.supabase.from("votes").select(`
          *,
          user:users(name, reputation_score),
          politician:politicians(name)
        `).order("created_at",{ascending:!1}).limit(50);"all"!==A&&(b=b.eq("status",A));let{data:c,error:d}=await b;if(console.log("Moderation dashboard - selectedTab:",A),console.log("Moderation dashboard - votesData:",c),console.log("Moderation dashboard - votesError:",d),d){console.log("Primary query had issues, using fallback query without JOINs:",d);let{data:a,error:b}=await i.supabase.from("votes").select("*").order("created_at",{ascending:!1}).limit(50);if(console.log("Fallback query - data:",a),console.log("Fallback query - error:",b),a&&!b){console.log("Using fallback data - found votes:",a.length);let b=a;"all"!==A&&(b=a.filter(a=>a.status===A));let c=[];b.forEach(a=>{c.push({id:a.id,type:"vote",status:a.status,priority:J(a),content:a,created_at:a.created_at,reviewed_at:a.reviewed_at,reviewed_by:a.reviewed_by})}),o(c),await I();return}}let{data:e}=await i.supabase.from("comments").select(`
          *,
          user:users(name, reputation_score)
        `).eq("is_flagged",!0).eq("status","active").order("created_at",{ascending:!1}).limit(20),f=[];c?.forEach(a=>{f.push({id:a.id,type:"vote",status:a.status,priority:J(a),content:a,created_at:a.created_at,reviewed_at:a.reviewed_at,reviewed_by:a.reviewed_by})}),e?.forEach(a=>{f.push({id:a.id,type:"comment",status:"flagged",priority:"medium",content:a,created_at:a.created_at})}),o(f),await I()}catch(a){console.error("Error fetching moderation data:",a)}finally{z(!1)}},I=async()=>{try{let{data:a}=await i.supabase.rpc("get_moderation_stats");a&&x(a[0])}catch(a){console.error("Error fetching stats:",a)}},J=a=>{if("vote"===a.type){if(a.points&&a.points>=50)return"urgent";if(a.points&&a.points>=20)return"high";if(a.points&&a.points>=10)return"medium"}return"low"},K=async(b,c,e)=>{if(a){G(a=>new Set(a).add(b));try{let f=d.find(a=>a.id===b);if(!f)return;"vote"===f.type?await i.supabase.from("votes").update({status:"approve"===c?"approved":"rejected",reviewed_at:new Date().toISOString(),reviewed_by:a.id,rejection_reason:e||null}).eq("id",b):"comment"===f.type&&await i.supabase.from("comments").update({status:"approve"===c?"active":"hidden",is_flagged:!1,moderated_at:new Date().toISOString(),moderated_by:a.id}).eq("id",b),await i.supabase.from("moderation_actions").insert({moderator_id:a.id,item_type:f.type,item_id:b,action:c,reason:e||null}),await H()}catch(a){console.error("Error moderating item:",a)}finally{G(a=>{let c=new Set(a);return c.delete(b),c})}}},L=async a=>{G(b=>new Set(b).add(a));try{let b=d.find(b=>b.id===a);if(!b)return;let c="",e="";"vote"===b.type?(c=String(b.content.evidence_title||""),e=String(b.content.evidence_description||"")+" "+String(b.content.evidence_url||"")):"comment"===b.type&&(e=c=String(b.content.content||""));let f=await j.checkFact(c,e,String(b.content.evidence_url||""));await i.supabase.from("vote"===b.type?"votes":"comments").update({ai_analysis:f}).eq("id",a),await H()}catch(a){console.error("Error running AI analysis:",a)}finally{G(b=>{let c=new Set(b);return c.delete(a),c})}};return a&&(a.user_metadata?.role==="admin"||a.user_metadata?.role==="moderator"||a.profile?.role==="admin"||a.profile?.role==="moderator")?y?(0,b.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,b.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,b.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-24 bg-gray-200 rounded-lg"},c))}),(0,b.jsx)("div",{className:"h-96 bg-gray-200 rounded-lg"})]})}):(0,b.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de modération"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Gérer le contenu et maintenir la qualité de la plateforme"})]}),(0,b.jsxs)(g.Button,{onClick:H,variant:"outline",size:"sm",children:[(0,b.jsx)(v,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]}),w&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"En attente"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:w.total_pending})]}),(0,b.jsx)(n.Clock,{className:"w-8 h-8 text-yellow-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Approuvés"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:w.total_approved})]}),(0,b.jsx)(l.CheckCircle,{className:"w-8 h-8 text-green-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Rejetés"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-red-600",children:w.total_rejected})]}),(0,b.jsx)(m.XCircle,{className:"w-8 h-8 text-red-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Précision IA"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[Math.round(w.accuracy_rate),"%"]})]}),(0,b.jsx)(t.BarChart3,{className:"w-8 h-8 text-blue-600"})]})})})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[(0,b.jsx)("div",{className:"flex space-x-2",children:[{key:"pending",label:"En attente",count:w?.total_pending||0},{key:"flagged",label:"Signalés",count:w?.total_flagged||0},{key:"approved",label:"Approuvés",count:w?.total_approved||0},{key:"rejected",label:"Rejetés",count:w?.total_rejected||0},{key:"all",label:"Tous",count:0}].map(a=>(0,b.jsxs)(g.Button,{onClick:()=>B(a.key),variant:A===a.key?"default":"outline",size:"sm",children:[a.label,a.count>0&&(0,b.jsx)(f.Badge,{variant:"secondary",className:"ml-2",children:a.count})]},a.key))}),(0,b.jsx)("div",{className:"flex items-center space-x-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(u,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Rechercher...",value:D,onChange:a=>E(a.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[d.filter(a=>!D||"vote"===a.type&&String(a.content.evidence_title||"").toLowerCase().includes(D.toLowerCase())||"comment"===a.type&&String(a.content.content||"").toLowerCase().includes(D.toLowerCase())).map(a=>(0,b.jsx)(e.Card,{className:C===a.id?"ring-2 ring-blue-500":"",children:(0,b.jsxs)(e.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${"vote"===a.type?"bg-blue-100 text-blue-600":"bg-purple-100 text-purple-600"}`,children:"vote"===a.type?(0,b.jsx)(t.BarChart3,{className:"w-5 h-5"}):(0,b.jsx)(r,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(f.Badge,{variant:"outline",className:(a=>{switch(a){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.priority),children:a.priority.toUpperCase()}),(0,b.jsx)(f.Badge,{variant:"outline",className:(a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"flagged":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.status),children:a.status}),(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"vote"===a.type?"Vote":"Commentaire"})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[new Date(a.created_at).toLocaleDateString("fr-FR")," à ",new Date(a.created_at).toLocaleTimeString("fr-FR")]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>L(a.id),disabled:F.has(a.id),variant:"outline",size:"sm",children:[(0,b.jsx)(q.Eye,{className:"w-4 h-4 mr-1"}),"Analyser"]}),"pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{onClick:()=>K(a.id,"approve"),disabled:F.has(a.id),variant:"outline",size:"sm",className:"text-green-600 hover:text-green-700",children:[(0,b.jsx)(l.CheckCircle,{className:"w-4 h-4 mr-1"}),"Approuver"]}),(0,b.jsxs)(g.Button,{onClick:()=>K(a.id,"reject"),disabled:F.has(a.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:[(0,b.jsx)(m.XCircle,{className:"w-4 h-4 mr-1"}),"Rejeter"]})]})]})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:["vote"===a.type?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:String(a.content.evidence_title||"")}),(0,b.jsx)("p",{className:"text-sm text-gray-700",children:String(a.content.evidence_description||"")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("span",{className:`font-medium ${"positive"===String(a.content.vote_type)?"text-green-600":"text-red-600"}`,children:["positive"===String(a.content.vote_type)?"+":"-",String(a.content.points||"0")," points"]}),(0,b.jsxs)("span",{className:"text-gray-600",children:["Catégorie: ",String(a.content.category||"")]})]}),!!a.content.evidence_url&&""!==String(a.content.evidence_url).trim()&&(0,b.jsxs)("a",{href:String(a.content.evidence_url||""),target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800",children:[(0,b.jsx)(s.ExternalLink,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Source"})]})]})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-700",children:String(a.content.content||"")}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mt-2",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:["Par ",String(a.content.user?.name||"Utilisateur anonyme")]}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"bg-orange-50 text-orange-700",children:[(0,b.jsx)(p,{className:"w-3 h-3 mr-1"}),"Signalé"]})]})]}),!!a.content.ai_analysis&&"object"==typeof a.content.ai_analysis&&null!==a.content.ai_analysis&&(0,b.jsxs)("div",{className:"border-t pt-3 mt-3",children:[(0,b.jsx)("h5",{className:"font-medium text-sm mb-2",children:"Analyse IA"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Résultat:"}),(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:String(a.content.ai_analysis?.result||"")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Confiance:"}),(0,b.jsxs)("span",{className:"font-medium",children:[Math.round(100*Number(a.content.ai_analysis?.confidence_score||0)),"%"]})]})]})]})]})]})},a.id)),0===d.length&&(0,b.jsx)(e.Card,{className:"text-center py-12",children:(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)(k.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Aucun élément à modérer"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Tous les éléments ont été traités."})]})})]})]}):(0,b.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,b.jsx)(e.Card,{className:"text-center py-12",children:(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)(k.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Accès non autorisé"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Vous devez être administrateur ou modérateur pour accéder à cette page."})]})})})}var x=a.i(73390);let y=new class{modelEndpoint=null;apiKey=null;constructor(){this.modelEndpoint=process.env.ML_THREAT_DETECTION_ENDPOINT||null,this.apiKey=process.env.ML_API_KEY||null}async analyzeThreat(a,b,c={}){try{let c=await this.getUserBehaviorProfile(b),d=await this.analyzeContent(a),e=await this.detectCoordinatedBehavior(b,a),f=await this.detectBotBehavior(c),g=await this.analyzeNetworkThreats(b),h={coordinated_behavior:e,bot_probability:f,spam_likelihood:d.spam_score,manipulation_risk:this.calculateManipulationRisk(c,d),disinformation_score:d.disinformation_score},i=this.calculateThreatLevel(h),j=this.identifyThreatTypes(h,d),k=this.detectAnomalies(c,d,g),l=this.generateRecommendations(i,j,k);return{threat_level:i,threat_types:j,confidence_score:this.calculateConfidence(h),risk_factors:h,anomalies:k.map(a=>({type:String(a.type||"unknown"),description:String(a.description||""),severity:Number(a.severity||0)})),recommendations:l}}catch(a){return console.error("Threat detection error:",a),{threat_level:"low",threat_types:[],confidence_score:0,risk_factors:{coordinated_behavior:0,bot_probability:0,spam_likelihood:0,manipulation_risk:0,disinformation_score:0},anomalies:[],recommendations:["Analyse manuelle recommandée - erreur système"]}}}async analyzeNetworkThreats(a="24h"){try{let a=await this.detectSuspiciousClusters(),b=await this.detectBotNetworks(),c=await this.detectInfluenceOperations();return{suspicious_clusters:a.map(a=>({cluster_id:String(a.cluster_id||""),size:Number(a.size||0),coordination_score:Number(a.coordination_score||0),members:Array.isArray(a.members)?a.members:[],behavior_patterns:Array.isArray(a.behavior_patterns)?a.behavior_patterns:[]})),bot_networks:b.map(a=>({network_id:String(a.network_id||""),confidence:Number(a.confidence||0),members:Array.isArray(a.members)?a.members:[],evidence:Array.isArray(a.evidence)?a.evidence:[]})),influence_operations:c.map(a=>({operation_id:String(a.operation_id||""),type:a.type||"disinformation",scale:Number(a.scale||0),targets:Array.isArray(a.targets)?a.targets:[],indicators:Array.isArray(a.indicators)?a.indicators:[]}))}}catch(a){return console.error("Network analysis error:",a),{suspicious_clusters:[],bot_networks:[],influence_operations:[]}}}async getUserBehaviorProfile(a){return{user_id:a,voting_patterns:{frequency:10*Math.random(),timing_variance:Math.random(),target_diversity:Math.random(),evidence_quality:Math.random()},engagement_metrics:{comment_frequency:5*Math.random(),interaction_depth:Math.random(),response_time_patterns:[100*Math.random(),100*Math.random()],activity_times:[24*Math.random(),24*Math.random()]},content_analysis:{sentiment_consistency:Math.random(),topic_focus:["politics","economics"],language_patterns:{},credibility_sources:10*Math.random()},network_analysis:{connection_patterns:{},influence_score:100*Math.random(),cluster_membership:[]}}}async analyzeContent(a){let b=["click here","free money","guaranteed","urgent","limited time"],c=b.filter(b=>a.toLowerCase().includes(b)).length/b.length,d=[/fake news/i,/conspiracy/i,/they don't want you to know/i,/wake up/i,/do your research/i],e=d.filter(b=>b.test(a)).length/d.length,f=["outrageous","shocking","unbelievable","scandalous","terrifying"];return{spam_score:c,disinformation_score:e,emotional_manipulation:f.filter(b=>a.toLowerCase().includes(b)).length/f.length,readability:this.calculateReadability(a),credibility_indicators:this.analyzeCredibilityIndicators(a)}}async detectCoordinatedBehavior(a,b){return Math.min(1,.3*Math.floor(3*Math.random())+.5*Math.random()+.3*Math.random())}async detectBotBehavior(a){let b=0;a.voting_patterns.timing_variance<.2&&(b+=.3),a.engagement_metrics.interaction_depth<.3&&(b+=.2);let c=this.calculateVariance(a.engagement_metrics.activity_times);return(c<2||c>10)&&(b+=.2),a.content_analysis.topic_focus.length<2&&(b+=.15),5>this.calculateVariance(a.engagement_metrics.response_time_patterns)&&(b+=.15),Math.min(1,b)}calculateManipulationRisk(a,b){let c=0;return a.voting_patterns.frequency>5&&a.voting_patterns.evidence_quality<.3&&(c+=.4),c+=.3*Number(b.emotional_manipulation),a.voting_patterns.target_diversity<.3&&(c+=.2),a.content_analysis.sentiment_consistency<.4&&(c+=.1),Math.min(1,c)}detectSuspiciousClusters(){return[{cluster_id:"cluster_001",size:15,coordination_score:.85,members:["user1","user2","user3"],behavior_patterns:["synchronized_voting","similar_content","timing_correlation"]}]}detectBotNetworks(){return[{network_id:"botnet_001",confidence:.78,members:["bot1","bot2","bot3"],evidence:["identical_timing","template_content","coordinated_targets"]}]}detectInfluenceOperations(){return[{operation_id:"influence_001",type:"astroturfing",scale:7.5,targets:["politician_123","politician_456"],indicators:["artificial_amplification","coordinated_messaging","fake_grassroots"]}]}calculateThreatLevel(a){let b=Object.values(a).reduce((a,b)=>a+Number(b),0)/Object.keys(a).length;return b>=.8?"critical":b>=.6?"high":b>=.3?"medium":"low"}identifyThreatTypes(a,b){let c=[];return Number(a.bot_probability)>.6&&c.push("bot_activity"),Number(a.coordinated_behavior)>.7&&c.push("coordinated_manipulation"),Number(a.spam_likelihood)>.5&&c.push("spam"),Number(a.disinformation_score)>.6&&c.push("disinformation"),Number(a.manipulation_risk)>.6&&c.push("vote_manipulation"),Number(b.emotional_manipulation)>.7&&c.push("emotional_manipulation"),c}detectAnomalies(a,b,c){let d=[];return a.voting_patterns.frequency>8&&d.push({type:"high_frequency_voting",description:"Fréquence de vote anormalement élevée",severity:6}),a.voting_patterns.timing_variance<.1&&d.push({type:"robotic_timing",description:"Patterns temporels trop réguliers (comportement robotique)",severity:7}),c.suspicious_clusters.length>0&&d.push({type:"cluster_membership",description:"Membre d'un cluster suspect",severity:8}),d}generateRecommendations(a,b,c){let d=[];return"critical"===a?(d.push("Blocage immédiat recommandé"),d.push("Investigation approfondie requise")):"high"===a?(d.push("Surveillance renforcée"),d.push("Révision manuelle de tous les contenus")):"medium"===a&&(d.push("Modération prioritaire"),d.push("Vérification des sources")),b.includes("bot_activity")&&d.push("Vérification CAPTCHA supplémentaire"),b.includes("coordinated_manipulation")&&d.push("Analyse du réseau de connexions"),b.includes("disinformation")&&d.push("Fact-checking approfondi requis"),c.some(a=>Number(a.severity)>=8)&&d.push("Escalade vers l'équipe sécurité"),d.length>0?d:["Surveillance standard"]}calculateConfidence(a){let b=Object.values(a),c=b.reduce((a,b)=>a+b,0)/b.length;return Math.max(.1,Math.min(1,1-b.reduce((a,b)=>a+Math.pow(b-c,2),0)/b.length))}calculateReadability(a){let b=a.split(/[.!?]+/).filter(a=>a.trim().length>0),c=a.split(/\s+/),d=c.reduce((a,b)=>a+this.countSyllables(b),0);return 0===b.length||0===c.length?0:Math.max(0,Math.min(100,206.835-1.015*(c.length/b.length)-84.6*(d/c.length)))/100}countSyllables(a){let b=0,c=!1;for(let d=0;d<a.length;d++){let e="aeiouy".includes(a[d].toLowerCase());e&&!c&&b++,c=e}return Math.max(1,b)}analyzeCredibilityIndicators(a){let b=.5;return/https?:\/\//.test(a)&&(b+=.2),/\d+%|\d+\s*(euros?|dollars?)|\d{4}/.test(a)&&(b+=.1),/(selon|d'après|il semble|probablement)/.test(a.toLowerCase())&&(b+=.1),/(toujours|jamais|tous|aucun)/.test(a.toLowerCase())&&!/https?:\/\//.test(a)&&(b-=.2),Math.max(0,Math.min(1,b))}hashContent(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return b.toString()}calculateVariance(a){if(0===a.length)return 0;let b=a.reduce((a,b)=>a+b,0)/a.length;return a.reduce((a,c)=>a+Math.pow(c-b,2),0)/a.length}async startRealTimeMonitoring(){console.log("Starting real-time threat monitoring...")}async stopRealTimeMonitoring(){console.log("Stopping real-time threat monitoring...")}async processBatchAnalysis(a){return console.log(`Processing batch analysis for ${a}...`),{processed_users:0,threats_detected:0,anomalies_found:0}}};var z=a.i(73570);let A=(0,o.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var B=a.i(60246);let C=(0,o.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var D=a.i(24669);let E=(0,o.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),F=(0,o.default)("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);var G=a.i(50429);function H(){let[a,d]=(0,c.useState)([]),[h,i]=(0,c.useState)(null),[j,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!0),[r,s]=(0,c.useState)("overview");(0,c.useEffect)(()=>{t(),u()},[]);let t=async()=>{try{p(!0);let a=[{id:"1",type:"coordinated_behavior",severity:"high",description:"Détection de comportement coordonné entre 15 comptes",user_id:"user_123",detected_at:new Date(Date.now()-18e5).toISOString(),status:"active",ml_confidence:.87},{id:"2",type:"bot_activity",severity:"medium",description:"Activité suspecte de bot détectée",user_id:"user_456",detected_at:new Date(Date.now()-72e5).toISOString(),status:"investigating",ml_confidence:.74},{id:"3",type:"disinformation",severity:"critical",description:"Propagation de désinformation détectée",content_id:"vote_789",detected_at:new Date(Date.now()-6e5).toISOString(),status:"active",ml_confidence:.92}];d(a);let b=await y.analyzeNetworkThreats();i(b)}catch(a){console.error("Error fetching threat data:",a)}finally{p(!1)}},u=async()=>{n(!0),await y.startRealTimeMonitoring()},w=async()=>{n(!1),await y.stopRealTimeMonitoring()},H=async(a,b)=>{d(c=>c.map(c=>c.id===a?{...c,status:b}:c))},I=a=>{switch(a){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},J=a=>{switch(a){case"bot_activity":return(0,b.jsx)(A,{className:"w-4 h-4"});case"coordinated_behavior":return(0,b.jsx)(B.Users,{className:"w-4 h-4"});case"disinformation":return(0,b.jsx)(z.AlertTriangle,{className:"w-4 h-4"});case"spam":return(0,b.jsx)(E,{className:"w-4 h-4"});case"manipulation":return(0,b.jsx)(G.Target,{className:"w-4 h-4"});default:return(0,b.jsx)(k.Shield,{className:"w-4 h-4"})}};return o?(0,b.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,b.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,b.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-24 bg-gray-200 rounded-lg"},c))}),(0,b.jsx)("div",{className:"h-96 bg-gray-200 rounded-lg"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Surveillance des menaces"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Détection automatisée des menaces par IA"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full ${j?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[(0,b.jsx)(C,{className:`w-4 h-4 ${j?"animate-pulse":""}`}),(0,b.jsx)("span",{className:"text-sm font-medium",children:j?"Surveillance active":"Surveillance arrêtée"})]}),(0,b.jsx)(g.Button,{onClick:j?w:u,variant:j?"destructive":"default",size:"sm",children:j?"Arrêter":"Démarrer"}),(0,b.jsxs)(g.Button,{onClick:t,variant:"outline",size:"sm",children:[(0,b.jsx)(v,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Menaces actives"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a.filter(a=>"active"===a.status).length})]}),(0,b.jsx)(z.AlertTriangle,{className:"w-8 h-8 text-red-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Bots détectés"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:a.filter(a=>"bot_activity"===a.type).length})]}),(0,b.jsx)(A,{className:"w-8 h-8 text-orange-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Réseaux suspects"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:h?.suspicious_clusters.length||0})]}),(0,b.jsx)(F,{className:"w-8 h-8 text-purple-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Confiance IA"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[a.length>0?Math.round(a.reduce((a,b)=>a+b.ml_confidence,0)/a.length*100):0,"%"]})]}),(0,b.jsx)(q.Eye,{className:"w-8 h-8 text-blue-600"})]})})})]}),(0,b.jsx)("div",{className:"border-b border-gray-200",children:(0,b.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Vue d'ensemble",icon:(0,b.jsx)(k.Shield,{className:"w-4 h-4"})},{key:"threats",label:"Menaces",icon:(0,b.jsx)(z.AlertTriangle,{className:"w-4 h-4"})},{key:"network",label:"Analyse réseau",icon:(0,b.jsx)(F,{className:"w-4 h-4"})},{key:"analytics",label:"Analytics ML",icon:(0,b.jsx)(D.TrendingUp,{className:"w-4 h-4"})}].map(a=>(0,b.jsxs)("button",{onClick:()=>s(a.key),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${r===a.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.icon,(0,b.jsx)("span",{children:a.label})]},a.key))})}),"overview"===r&&(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Menaces récentes"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:a.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[J(a.type),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.description}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:new Date(a.detected_at).toLocaleString("fr-FR")})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(f.Badge,{variant:"outline",className:I(a.severity),children:a.severity}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(100*a.ml_confidence),"%"]})]})]},a.id))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Analyse de tendances"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{children:"Activité bot"}),(0,b.jsx)("span",{children:"23%"})]}),(0,b.jsx)(x.Progress,{value:23,className:"h-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{children:"Coordination suspecte"}),(0,b.jsx)("span",{children:"45%"})]}),(0,b.jsx)(x.Progress,{value:45,className:"h-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{children:"Désinformation"}),(0,b.jsx)("span",{children:"12%"})]}),(0,b.jsx)(x.Progress,{value:12,className:"h-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{children:"Manipulation"}),(0,b.jsx)("span",{children:"31%"})]}),(0,b.jsx)(x.Progress,{value:31,className:"h-2"})]})]})})]})]}),"threats"===r&&(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${"critical"===a.severity?"bg-red-100 text-red-600":"high"===a.severity?"bg-orange-100 text-orange-600":"medium"===a.severity?"bg-yellow-100 text-yellow-600":"bg-blue-100 text-blue-600"}`,children:J(a.type)}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,b.jsxs)("span",{children:["Type: ",a.type]}),(0,b.jsxs)("span",{children:["Confiance: ",Math.round(100*a.ml_confidence),"%"]}),(0,b.jsx)("span",{children:new Date(a.detected_at).toLocaleString("fr-FR")})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(f.Badge,{variant:"outline",className:I(a.severity),children:a.severity}),(0,b.jsx)(f.Badge,{variant:"outline",className:(a=>{switch(a){case"active":return"bg-red-100 text-red-800 border-red-200";case"investigating":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.status),children:a.status})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>H(a.id,"investigating"),size:"sm",variant:"outline",children:[(0,b.jsx)(q.Eye,{className:"w-4 h-4 mr-1"}),"Enquêter"]}),(0,b.jsxs)(g.Button,{onClick:()=>H(a.id,"resolved"),size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700",children:[(0,b.jsx)(l.CheckCircle,{className:"w-4 h-4 mr-1"}),"Résolu"]}),(0,b.jsxs)(g.Button,{onClick:()=>H(a.id,"false_positive"),size:"sm",variant:"outline",className:"text-gray-600 hover:text-gray-700",children:[(0,b.jsx)(m.XCircle,{className:"w-4 h-4 mr-1"}),"Faux positif"]})]})]})},a.id))}),"network"===r&&(0,b.jsx)("div",{className:"space-y-6",children:h&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Clusters suspects"})}),(0,b.jsx)(e.CardContent,{children:0===h.suspicious_clusters.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucun cluster suspect détecté"}):(0,b.jsx)("div",{className:"space-y-4",children:h.suspicious_clusters.map(a=>(0,b.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("h4",{className:"font-medium",children:["Cluster ",a.cluster_id]}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"bg-orange-50 text-orange-700",children:[a.size," membres"]})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Score de coordination: ",Math.round(100*a.coordination_score),"%"]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.behavior_patterns.map((a,c)=>(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:a},c))})]},a.cluster_id))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Réseaux de bots"})}),(0,b.jsx)(e.CardContent,{children:0===h.bot_networks.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Aucun réseau de bots détecté"}):(0,b.jsx)("div",{className:"space-y-4",children:h.bot_networks.map(a=>(0,b.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("h4",{className:"font-medium",children:["Réseau ",a.network_id]}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"bg-red-50 text-red-700",children:["Confiance: ",Math.round(100*a.confidence),"%"]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.evidence.map((a,c)=>(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:a},c))})]},a.network_id))})})]})]})}),"analytics"===r&&(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Analytics Machine Learning"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(D.TrendingUp,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"font-medium mb-2",children:"Analytics ML avancées"}),(0,b.jsx)("p",{className:"text-sm",children:"Analyses détaillées et métriques de performance des modèles à venir."})]})})]})]})}let I=(0,o.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),J=(0,o.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function K(){let{user:a,loading:j}=(0,h.useAuth)(),[l,m]=(0,c.useState)("overview"),[n,o]=(0,c.useState)(null),[p,r]=(0,c.useState)([]),[s,u]=(0,c.useState)(!0);(0,c.useEffect)(()=>{a&&(a.user_metadata?.role==="admin"||a.user_metadata?.role==="moderator"||a.profile?.role==="admin"||a.profile?.role==="moderator")&&(v(),x())},[a]);let v=async()=>{try{u(!0);let{count:a}=await i.supabase.from("users").select("*",{count:"exact",head:!0}),b=new Date().toISOString().split("T")[0],{count:c}=await i.supabase.from("votes").select("*",{count:"exact",head:!0}).gte("created_at",b),{count:d,data:e}=await i.supabase.from("votes").select("*",{count:"exact"}).eq("status","pending");console.log("Admin dashboard - pending count:",d),console.log("Admin dashboard - pending votes:",e),o({total_users:a||0,votes_today:c||0,pending_moderation:d||0,system_health:98})}catch(a){console.error("Error fetching admin stats:",a)}finally{u(!1)}},x=async()=>{try{let{data:a}=await i.supabase.from("moderation_actions").select(`
          *,
          moderator:users!moderator_id(name)
        `).order("created_at",{ascending:!1}).limit(10),{data:b}=await i.supabase.from("users").select("id, name, created_at").order("created_at",{ascending:!1}).limit(5),c=[];a?.forEach(a=>{c.push({id:a.id,action:"approve"===a.action?"Vote approuvé":"Vote rejeté",user:a.moderator?.name||"Modérateur",time:y(a.created_at),type:"approve"===a.action?"approval":"rejection"})}),b?.forEach(a=>{c.push({id:a.id,action:"Nouveau utilisateur",user:a.name||"Utilisateur",time:y(a.created_at),type:"user"})}),c.sort((a,b)=>new Date(b.time).getTime()-new Date(a.time).getTime()),r(c.slice(0,8))}catch(a){console.error("Error fetching recent activity:",a)}},y=a=>{let b=new Date,c=new Date(a),d=Math.floor((b.getTime()-c.getTime())/6e4);return d<1?"À l'instant":d<60?`Il y a ${d} min`:d<1440?`Il y a ${Math.floor(d/60)}h`:`Il y a ${Math.floor(d/1440)} jour(s)`};if(j)return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(d.Navigation,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsx)("div",{className:"text-center",children:"Chargement..."})})]});if(!a||a.user_metadata?.role!=="admin"&&a.user_metadata?.role!=="moderator"&&a.profile?.role!=="admin"&&a.profile?.role!=="moderator")return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(d.Navigation,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsx)(e.Card,{className:"text-center py-12",children:(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)(k.Shield,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Accès non autorisé"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Vous devez être administrateur ou modérateur pour accéder à cette page."})]})})})]});let A=a.user_metadata?.role==="admin"||a.profile?.role==="admin";return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(d.Navigation,{}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:A?"Administration":"Modération"}),(0,b.jsx)("p",{className:"text-gray-600",children:A?"Gérer la plateforme et superviser les modérateurs":"Modérer le contenu et maintenir la qualité"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(f.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,b.jsx)(k.Shield,{className:"w-3 h-3 mr-1"}),A?"Administrateur":"Modérateur"]}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.profile?.name||a.email})]})]})}),(0,b.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,b.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Vue d'ensemble",icon:(0,b.jsx)(t.BarChart3,{className:"w-4 h-4"}),adminOnly:!1},{key:"moderation",label:"Modération",icon:(0,b.jsx)(k.Shield,{className:"w-4 h-4"}),adminOnly:!1},{key:"threats",label:"Menaces IA",icon:(0,b.jsx)(q.Eye,{className:"w-4 h-4"}),adminOnly:!1},{key:"users",label:"Utilisateurs",icon:(0,b.jsx)(B.Users,{className:"w-4 h-4"}),adminOnly:!0},{key:"analytics",label:"Analytics",icon:(0,b.jsx)(D.TrendingUp,{className:"w-4 h-4"}),adminOnly:!0},{key:"settings",label:"Paramètres",icon:(0,b.jsx)(I,{className:"w-4 h-4"}),adminOnly:!0}].filter(a=>!a.adminOnly||A).map(a=>(0,b.jsxs)("button",{onClick:()=>m(a.key),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${l===a.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.icon,(0,b.jsx)("span",{children:a.label})]},a.key))})}),"overview"===l&&(0,b.jsxs)("div",{className:"space-y-6",children:[s?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"animate-pulse",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:n?.total_users||0})]}),(0,b.jsx)(B.Users,{className:"w-8 h-8 text-blue-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Votes Today"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:n?.votes_today||0})]}),(0,b.jsx)(t.BarChart3,{className:"w-8 h-8 text-green-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Pending Moderation"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:n?.pending_moderation||0})]}),(0,b.jsx)(z.AlertTriangle,{className:"w-8 h-8 text-orange-600"})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"System Health"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[n?.system_health||0,"%"]})]}),(0,b.jsx)(C,{className:"w-8 h-8 text-green-600"})]})})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Activité récente"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:p.length>0?p.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${"approval"===a.type?"bg-green-500":"flag"===a.type?"bg-orange-500":"user"===a.type?"bg-blue-500":"bg-red-500"}`}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.action}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.user})]})]}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:a.time})]},a.id)):(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,b.jsx)("p",{className:"text-sm",children:"Aucune activité récente"})})})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Actions rapides"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(g.Button,{className:"w-full justify-start",variant:"outline",onClick:()=>m("moderation"),children:[(0,b.jsx)(k.Shield,{className:"w-4 h-4 mr-2"}),"Réviser la modération"]}),(0,b.jsxs)(g.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(B.Users,{className:"w-4 h-4 mr-2"}),"Gérer les utilisateurs"]}),(0,b.jsxs)(g.Button,{className:"w-full justify-start",variant:"outline",onClick:()=>{v(),x()},children:[(0,b.jsx)(J,{className:"w-4 h-4 mr-2"}),"Actualiser les données"]}),(0,b.jsxs)(g.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(I,{className:"w-4 h-4 mr-2"}),"Configuration système"]})]})})]})]})]}),"moderation"===l&&(0,b.jsx)(w,{}),"threats"===l&&(0,b.jsx)(H,{}),"users"===l&&A&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Gestion des utilisateurs"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(B.Users,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"font-medium mb-2",children:"Gestion des utilisateurs"}),(0,b.jsx)("p",{className:"text-sm",children:"Cette fonctionnalité sera disponible prochainement."})]})})]})}),"analytics"===l&&A&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Analytics avancées"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(D.TrendingUp,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"font-medium mb-2",children:"Analytics détaillées"}),(0,b.jsx)("p",{className:"text-sm",children:"Analyses approfondies en développement."})]})})]})}),"settings"===l&&A&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Paramètres système"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(I,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"font-medium mb-2",children:"Configuration système"}),(0,b.jsx)("p",{className:"text-sm",children:"Paramètres avancés à venir."})]})})]})})]})]})}}];

//# sourceMappingURL=src_app_admin_page_tsx_645532da._.js.map